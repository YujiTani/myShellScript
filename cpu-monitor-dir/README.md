# CPU Monitor

CPUの使用率を監視し、高負荷プロセスを追跡するスクリプトです。JSON形式でログを出力し、詳細な分析レポートを生成できます。

## ファイル構成

```
cpu-monitor-dir/
├── high-cpu-tracker.sh    # CPUモニタリングスクリプト
├── logs/                  # ログファイル保存ディレクトリ
│   └── cpu_monitor_log_sample.json
└── reports/               # 分析レポート保存ディレクトリ
    ├── cpu_analysis_report_20250622_004211.md
    └── cpu_analysis_report_20250622_084104.md
```

## 使用方法

```bash
./high-cpu-tracker.sh
```

実行すると、ログファイルが `logs/` ディレクトリに自動生成されます。

## 動作概要

- **監視時間**: 1分間（5秒間隔で12回測定）
- **CPU閾値**: 10%以上のプロセスを記録
- **記録数**: 各測定で最大5プロセス
- **出力形式**: JSON形式でシステム情報と測定データを保存

## 設定値

スクリプト内で以下の値を調整可能：

```bash
CPU_THRESHOLD_PERCENT=10        # CPU使用率閾値（%）
MAX_PROCESSES_PER_MEASUREMENT=5 # 測定あたりの最大プロセス数
INTERVAL_SECONDS=5              # 測定間隔（秒）
TOTAL_MEASUREMENTS=12           # 総測定回数
```

## 出力データ構造

### JSONログファイル
- **システム情報**: CPUコア数、負荷平均、稼働時間
- **監視設定**: 閾値、間隔、測定回数
- **測定データ**: タイムスタンプ、PID、CPU使用率、メモリ使用率、実行時間、コマンド名

### 分析レポート（手動生成）
- 高負荷プロセスの特定
- 時系列パターン分析
- 根本原因分析
- 推奨対処法

## 要件

- macOS/Linux環境
- Bash環境
- `ps`、`awk`、`sysctl`コマンド
- 書き込み権限（ログディレクトリ作成用）

## 活用例

1. **リアルタイム監視**: システムパフォーマンス低下時の原因特定
2. **定期監視**: cronで定期実行し、負荷傾向を把握
3. **トラブルシューティング**: 異常プロセスの詳細な記録と分析